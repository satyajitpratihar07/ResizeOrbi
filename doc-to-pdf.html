<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOC to PDF Converter | Resize_Orbi</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.21/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        
        :root {
            --primary-color: #9932cc;
            --secondary-color: #ff8c00;
            --text-color: #f9f3f3;
            --bg-color: #e8e8e8;
            --card-bg: #235cb1;
            --border-color: #e0e0e0;
            --shadow-color: rgba(0,0,0,0.1);
            --header-bg: #272222;
            --footer-bg: #f8f9fa;
            --input-bg: #424242;
        }

       
        [data-theme="dark"] {
            --primary-color: #bb86fc;
            --secondary-color: #ffab40;
            --text-color: #e0e0e0;
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --border-color: #333;
            --shadow-color: rgba(0,0,0,0.3);
            --header-bg: #1e1e1e;
            --footer-bg: #1e1e1e;
            --input-bg: #2d2d2d;
        }

        body {
            background-color: var(--bg-color);
            color: rgb(92, 162, 199);
            transition: all 0.3s ease;
        }

        header, footer {
            background-color: var(--header-bg);
            border-color: var(--border-color);
        }

        footer {
            background-color:rgb(104, 104, 104);
        }

       
        .theme-switch-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-left: 20px;
        }

        .theme-switch {
            display: inline-block;
            position: relative;
            width: 60px;
            height: 30px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #200808;
            transition: .4s;
            border-radius: 30px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.2);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 2px;
            bottom: 2px;
            background-color: rgb(20, 117, 187);
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 0 3px rgba(0,0,0,0.3);
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .slider .icons {
            display: flex;
            justify-content: space-between;
            padding: 5px 10px;
            color: white;
        }
        
        .theme-label {
            font-size: 0.8rem;
            margin-top: 5px;
            font-weight: bold;
            color: rebeccapurple;
        }

        .upload-container {
            position: relative;
            border: 3px dashed var(--primary-color);
            border-radius: 8px;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: rgba(153, 50, 204, 0.08);
            margin: 2rem auto;
            max-width: 600px;
            box-shadow: 0 4px 12px var(--shadow-color);
        }

        .upload-container:hover {
            background-color: rgba(153, 50, 204, 0.15);
            border-color: #8a2be2;
            transform: translateY(-3px);
        }

        .upload-container.dragover {
            background-color: rgba(153, 50, 204, 0.25);
            border-color: #8a2be2;
            transform: scale(1.03);
        }

        .upload-container i {
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .file-info {
            display: none;
            margin: 2rem 0;
            padding: 1.5rem;
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 8px var(--shadow-color);
        }

        .progress-bar {
            height: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
            margin: 1.5rem 0;
            overflow: hidden;
            display: none;
        }

        .progress {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin: 1.5rem 0;
        }

        .convert-btn, .download-btn, .reset-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .convert-btn {
            background-color: var(--primary-color);
            color: white;
        }

        .convert-btn:hover {
            background-color: #8a2be2;
            transform: translateY(-2px);
        }

        .convert-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .reset-btn {
            background-color: #6c757d;
            color: white;
        }

        .reset-btn:hover {
            background-color: #5a6268;
        }

        .download-btn {
            display: none;
            background-color: #28a745;
            color: white;
            text-decoration: none;
            text-align: center;
        }

        .download-btn:hover {
            background-color: #218838;
            transform: translateY(-2px);
        }

        .error-message {
            color: #dc3545;
            background-color: rgba(220, 53, 69, 0.1);
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
            display: none;
        }

        .settings-section {
            padding: 1rem;
            background-color: var(--card-bg);
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .settings-section h3 {
            margin-top: 0;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .settings-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 1rem;
        }

        .settings-group {
            flex: 1;
            min-width: 200px;
        }

        .settings-group label {
            display: block;
            margin-bottom: 0.5rem;
        }

        select, input[type="number"] {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            color: var(--text-color);
            width: 100%;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin: 1rem 0;
        }

        .checkbox-group input {
            margin-right: 8px;
        }

        #doc-preview {
            margin: 2rem 0;
            padding: 1rem;
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 2px 8px var(--shadow-color);
            overflow-x: auto;
            color: #000;
        }

        #doc-preview h1, #doc-preview h2, #doc-preview h3 {
            color: #000;
        }

        .compatibility-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 1.5rem 0;
        }

        .compatibility-icon i {
            font-size: 1.5rem;
            margin: 0 0.5rem;
            color: var(--primary-color);
        }

        .compatibility-text {
            font-weight: bold;
            color: var(--text-color);
        }

        /* Hide the preview when in dark mode */
        [data-theme="dark"] #doc-preview {
            background-color: #f8f9fa;
            color: #000;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <img src="logo-r.svg" alt="Resize_Orbi Logo" class="logo-img">
                <h1>Resize_Orbi</h1>
            </div>
            <ul class="nav-links">
                <li><a href="index.html">
                    <span style="color: #fb1616;"><h>Home</h></span>
                </a></li>
                <li><a href="index.html#about">
                    <span style="color: #fcfcfc;"><h>About</h></span>
                </a></li>
                <li><a href="index.html#contact">
                    <span style="color: #15ea12;"><h>Developed By</h></span>
                </a></li>
                <li class="theme-switch-wrapper">
                    <label class="theme-switch" for="checkbox">
                        <input type="checkbox" id="checkbox" />
                        <div class="slider">
                            <div class="icons">
                                <i class="fas fa-sun"></i>
                                <i class="fas fa-moon"></i>
                            </div>
                        </div>
                    </label>
                    <span class="theme-label">Light/Dark</span>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="converter-container">
            <h1>DOC to PDF Converter</h1>
            <p>Convert your Word DOC files to PDF format quickly and easily.</p>
            
            <div class="compatibility-icon">
                <i class="fas fa-file-word"></i>
                <i class="fas fa-arrow-right"></i>
                <i class="fas fa-file-pdf"></i>
                <span class="compatibility-text">Convert DOC/DOCX files to PDF</span>
            </div>
            
            <div class="upload-container">
                <i class="fas fa-file-word"></i>
                <h3>Upload Word Document</h3>
                <p>Drag & drop your file here or click to browse</p>
                <p class="file-type-hint">Accepted formats: DOC, DOCX</p>
                <input type="file" id="file-input" accept=".doc,.docx">
            </div>
            
            <div class="file-info">
                <h3>Document Information</h3>
                <p>Filename: <span id="file-name"></span></p>
                
                <div class="settings-section">
                    <h3>PDF Settings</h3>
                    <div class="settings-row">
                        <div class="settings-group">
                            <label for="page-size">Page Size:</label>
                            <select id="page-size">
                                <option value="a4" selected>A4</option>
                                <option value="letter">Letter</option>
                                <option value="legal">Legal</option>
                            </select>
                        </div>
                        
                        <div class="settings-group">
                            <label for="orientation">Orientation:</label>
                            <select id="orientation">
                                <option value="portrait" selected>Portrait</option>
                                <option value="landscape">Landscape</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="settings-row">
                        <div class="settings-group">
                            <label for="margin">Margins (mm):</label>
                            <input type="number" id="margin" min="0" max="50" value="10">
                        </div>
                        
                        <div class="settings-group">
                            <label for="font-size">Base Font Size:</label>
                            <select id="font-size">
                                <option value="small">Small</option>
                                <option value="normal" selected>Normal</option>
                                <option value="large">Large</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="preserve-images" checked>
                        <label for="preserve-images">Preserve Images</label>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="preserve-styles" checked>
                        <label for="preserve-styles">Preserve Styles</label>
                    </div>
                </div>
                
                <h3>Document Preview</h3>
                <div id="doc-preview"></div>
                
                <div class="progress-bar">
                    <div class="progress"></div>
                </div>
                
                <div class="button-group">
                    <button id="convert-btn" class="convert-btn">Convert to PDF</button>
                    <button id="reset-btn" class="reset-btn">Clear & Upload New</button>
                </div>
                
                <a href="#" id="download-btn" class="download-btn">Download PDF</a>
                
                <p class="error-message" id="error-message"></p>
            </div>
            
            <div class="conversion-info">
                <h3>About DOC to PDF Conversion</h3>
                <p>Our DOC to PDF converter transforms Microsoft Word documents into high-quality PDF files that maintain your original formatting. This tool is perfect for:</p>
                <ul>
                    <li>Creating non-editable versions of important documents</li>
                    <li>Preparing files for professional printing</li>
                    <li>Sharing documents that will look the same on any device</li>
                    <li>Creating documents that comply with archival standards</li>
                </ul>
                <p>The conversion process preserves fonts, images, tables, and other formatting elements while creating a document that can be opened on virtually any device without requiring Microsoft Word.</p>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>
                    <span style="color: #d84d4d;"><h>Resize_Orbi</h></span>
                </h3>
                <p>Your one-stop solution for all file conversion needs</p>
            </div>
            <div class="footer-section">
                <h3>
                    <span style="color: #d84d4d;"><h>Quick Action</h></span>
                </h3>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html#about">About</a></li>
                    <li><a href="index.html#contact">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>
                    <span style="color: #d84d4d;"><h>Contact With Developer</h></span>
                </h3>
                <p>Email: satyajitpratihar26@gmail.com</p>
                
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2023 Resize_Orbi. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get jsPDF instance
            const { jsPDF } = window.jspdf;
            
            // Theme switcher
            const toggleSwitch = document.querySelector('#checkbox');
            const currentTheme = localStorage.getItem('theme');
            
            // Check if theme is already stored
            if (currentTheme) {
                document.documentElement.setAttribute('data-theme', currentTheme);
                if (currentTheme === 'dark') {
                    toggleSwitch.checked = true;
                }
            }
            
            // Handle theme switch
            function switchTheme(e) {
                if (e.target.checked) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                    localStorage.setItem('theme', 'light');
                }    
            }
            
            // Add event listener
            toggleSwitch.addEventListener('change', switchTheme, false);
            
            // DOC to PDF Converter functionality
            const fileInput = document.getElementById('file-input');
            const uploadContainer = document.querySelector('.upload-container');
            const fileInfo = document.querySelector('.file-info');
            const fileName = document.getElementById('file-name');
            const convertBtn = document.getElementById('convert-btn');
            const resetBtn = document.getElementById('reset-btn');
            const downloadBtn = document.getElementById('download-btn');
            const errorMessage = document.getElementById('error-message');
            const progressBar = document.querySelector('.progress');
            const docPreview = document.getElementById('doc-preview');
            const pageSize = document.getElementById('page-size');
            const orientation = document.getElementById('orientation');
            const margin = document.getElementById('margin');
            const fontSize = document.getElementById('font-size');
            const preserveImages = document.getElementById('preserve-images');
            const preserveStyles = document.getElementById('preserve-styles');
            
            // Variables to store document data
            let docFile = null;
            let docHtml = null;
            let downloadUrl = null;
            
            // Handle file selection
            fileInput.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    handleFileSelection(e.target.files[0]);
                }
            });
            
            // Drag and drop handlers
            uploadContainer.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('dragover');
            });
            
            uploadContainer.addEventListener('dragleave', function() {
                this.classList.remove('dragover');
            });
            
            uploadContainer.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
                
                if (e.dataTransfer.files.length > 0) {
                    handleFileSelection(e.dataTransfer.files[0]);
                }
            });
            
            // Click to select file
            uploadContainer.addEventListener('click', function() {
                fileInput.click();
            });
            
            // Handle reset button
            resetBtn.addEventListener('click', function() {
                resetForm();
            });
            
            // Handle convert button
            convertBtn.addEventListener('click', function() {
                if (!docFile) {
                    showError('Please select a DOC or DOCX file.');
                    return;
                }
                
                convertDocToPdf();
            });
            
            // Function to handle file selection
            function handleFileSelection(file) {
                // Check if it's a DOC or DOCX file
                if (!file.name.toLowerCase().endsWith('.doc') && !file.name.toLowerCase().endsWith('.docx')) {
                    showError('Please select a valid DOC or DOCX file.');
                    return;
                }
                
                // Store the file
                docFile = file;
                fileName.textContent = file.name;
                
                // Show file info section
                fileInfo.style.display = 'block';
                
                // Hide download button
                downloadBtn.style.display = 'none';
                
                // Load the document
                loadDocument(file);
            }
            
            // Function to load the document
            function loadDocument(file) {
                const reader = new FileReader();
                
                // Show progress bar
                progressBar.parentElement.style.display = 'block';
                progressBar.style.width = '30%';
                
                reader.onload = function(e) {
                    const arrayBuffer = e.target.result;
                    
                    // Use mammoth.js to convert the document to HTML
                    mammoth.convertToHtml({ arrayBuffer: arrayBuffer }, {
                        includeEmbeddedStyleMap: preserveStyles.checked
                    })
                    .then(function(result) {
                        // Update progress
                        progressBar.style.width = '70%';
                        
                        docHtml = result.value;
                        
                        // Display the HTML preview
                        docPreview.innerHTML = docHtml;
                        
                        // Apply font size adjustments based on selection
                        applyFontSizeAdjustment();
                        
                        // Update progress and hide progress bar
                        progressBar.style.width = '100%';
                        setTimeout(function() {
                            progressBar.parentElement.style.display = 'none';
                            progressBar.style.width = '0%';
                        }, 500);
                        
                        // Enable convert button
                        convertBtn.disabled = false;
                        
                        // Log any warnings
                        if (result.messages.length > 0) {
                            console.warn('Conversion warnings:', result.messages);
                        }
                    })
                    .catch(function(error) {
                        showError('Error processing document: ' + error.message);
                        console.error(error);
                        progressBar.parentElement.style.display = 'none';
                    });
                };
                
                reader.onerror = function() {
                    showError('Error reading the file.');
                    progressBar.parentElement.style.display = 'none';
                };
                
                reader.readAsArrayBuffer(file);
            }
            
            // Function to apply font size adjustment
            function applyFontSizeAdjustment() {
                const size = fontSize.value;
                
                // Remove previous adjustments
                docPreview.classList.remove('font-small', 'font-normal', 'font-large');
                
                // Apply new adjustment
                if (size === 'small') {
                    docPreview.style.fontSize = '0.9em';
                } else if (size === 'normal') {
                    docPreview.style.fontSize = '1em';
                } else if (size === 'large') {
                    docPreview.style.fontSize = '1.1em';
                }
            }
            
            // Listen for font size changes
            fontSize.addEventListener('change', applyFontSizeAdjustment);
            
            // Function to convert DOC to PDF
            function convertDocToPdf() {
                if (!docHtml) {
                    showError('Document content not available for conversion.');
                    return;
                }
                
                // Show progress bar
                progressBar.parentElement.style.display = 'block';
                progressBar.style.width = '10%';
                
                // Disable convert button
                convertBtn.disabled = true;
                
                // Get settings
                const pdfPageSize = pageSize.value;
                const pdfOrientation = orientation.value;
                const pdfMargin = parseInt(margin.value, 10);
                
                // Update progress
                progressBar.style.width = '30%';
                
                // Create PDF
                const pdfPageSizes = {
                    'a4': [210, 297],
                    'letter': [216, 279],
                    'legal': [216, 356]
                };
                
                const pdfPageWidth = pdfPageSizes[pdfPageSize][0];
                const pdfPageHeight = pdfPageSizes[pdfPageSize][1];
                
                // Initialize jsPDF
                const pdf = new jsPDF({
                    orientation: pdfOrientation,
                    unit: 'mm',
                    format: pdfPageSize
                });
                
                // Update progress
                progressBar.style.width = '50%';
                
                // Use html2canvas to render the document preview
                html2canvas(docPreview, {
                    scale: 2, // Higher scale for better quality
                    useCORS: true, // Allow loading cross-origin images
                    logging: false
                }).then(function(canvas) {
                    // Update progress
                    progressBar.style.width = '70%';
                    
                    // Calculate aspect ratio to fit within page with margins
                    const contentWidth = pdfOrientation === 'portrait' ? pdfPageWidth - (pdfMargin * 2) : pdfPageHeight - (pdfMargin * 2);
                    const contentHeight = pdfOrientation === 'portrait' ? pdfPageHeight - (pdfMargin * 2) : pdfPageWidth - (pdfMargin * 2);
                    
                    const canvasWidth = canvas.width;
                    const canvasHeight = canvas.height;
                    
                    // Determine if we need to scale based on width or height
                    let scale = 1;
                    if (canvasWidth > contentWidth) {
                        scale = contentWidth / canvasWidth;
                    }
                    
                    const scaledWidth = canvasWidth * scale;
                    const scaledHeight = canvasHeight * scale;
                    
                    // Calculate if we need multiple pages
                    const pageCount = Math.ceil(scaledHeight / contentHeight);
                    
                    // Add images for each page
                    for (let i = 0; i < pageCount; i++) {
                        if (i > 0) {
                            pdf.addPage();
                        }
                        
                        // Calculate which portion of the canvas to use for this page
                        const sourceY = i * (canvasHeight / pageCount);
                        const sourceHeight = canvasHeight / pageCount;
                        
                        // Add the image to the PDF
                        const imgData = canvas.toDataURL('image/jpeg', 1.0);
                        pdf.addImage(
                            imgData, 
                            'JPEG', 
                            pdfMargin, 
                            pdfMargin, 
                            scaledWidth, 
                            scaledHeight,
                            null, 
                            'FAST',
                            0,
                            sourceY / canvasHeight,
                            1,
                            (sourceY + sourceHeight) / canvasHeight
                        );
                    }
                    
                    // Update progress
                    progressBar.style.width = '90%';
                    
                    // Create a blob from the PDF
                    const pdfBlob = pdf.output('blob');
                    
                    // Create download URL
                    if (downloadUrl) {
                        URL.revokeObjectURL(downloadUrl);
                    }
                    
                    downloadUrl = URL.createObjectURL(pdfBlob);
                    
                    // Update download button
                    downloadBtn.href = downloadUrl;
                    downloadBtn.download = fileName.textContent.replace(/\.(doc|docx)$/i, '.pdf');
                    downloadBtn.style.display = 'inline-block';
                    
                    // Update progress
                    progressBar.style.width = '100%';
                    
                    // Hide progress bar after a delay
                    setTimeout(function() {
                        progressBar.parentElement.style.display = 'none';
                        progressBar.style.width = '0%';
                        
                        // Enable convert button
                        convertBtn.disabled = false;
                        
                        // Scroll to download button
                        downloadBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }, 500);
                })
                .catch(function(error) {
                    showError('Error generating PDF: ' + error.message);
                    console.error(error);
                    
                    // Hide progress bar
                    progressBar.parentElement.style.display = 'none';
                    progressBar.style.width = '0%';
                    
                    // Enable convert button
                    convertBtn.disabled = false;
                });
            }
            
            // Function to reset the form
            function resetForm() {
                // Reset file input
                fileInput.value = '';
                
                // Hide file info section
                fileInfo.style.display = 'none';
                
                // Clear document
                docFile = null;
                docHtml = null;
                
                // Clear document preview
                docPreview.innerHTML = '';
                
                // Hide progress bar
                progressBar.parentElement.style.display = 'none';
                progressBar.style.width = '0%';
                
                // Hide download button
                downloadBtn.style.display = 'none';
                
                // Clean up URLs
                if (downloadUrl) {
                    URL.revokeObjectURL(downloadUrl);
                    downloadUrl = null;
                }
                
                // Clear error message
                errorMessage.style.display = 'none';
                errorMessage.textContent = '';
                
                // Reset settings to defaults
                pageSize.value = 'a4';
                orientation.value = 'portrait';
                margin.value = '10';
                fontSize.value = 'normal';
                preserveImages.checked = true;
                preserveStyles.checked = true;
            }
            
            // Function to show error message
            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                setTimeout(function() {
                    errorMessage.style.opacity = '1';
                }, 10);
                setTimeout(function() {
                    errorMessage.style.opacity = '0';
                    setTimeout(function() {
                        errorMessage.style.display = 'none';
                    }, 500);
                }, 5000);
            }
        });
    </script>
</body>
</html> 