<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word to PDF Converter | Resize_Orbi</title>
       <link rel="shortcut icon" href="fg.png">
    <div class="logo-box">
    <img src="s1.png" alt="Logo" class="site-logo">
</div>
    <link rel="stylesheet" href="styles.css">
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* Dark Mode Variables */
        :root {
            --primary-color: #9932cc;
            --secondary-color: #ff8c00;
            --text-color: #333;
            --bg-color: #e8e8e8;
            --card-bg: #f5f7fa;
            --border-color: #e0e0e0;
            --shadow-color: rgba(0,0,0,0.1);
            --header-bg: #1e1c1c;
            --footer-bg: #f8f9fa;
            --input-bg: #fff;
        }

        /* Dark Mode Variables */
        [data-theme="dark"] {
            --primary-color: #bb86fc;
            --secondary-color: #ffab40;
            --text-color: #e0e0e0;
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --border-color: #333;
            --shadow-color: rgba(0,0,0,0.3);
            --header-bg: #1e1e1e;
            --footer-bg: #1e1e1e;
            --input-bg: #2d2d2d;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        header, footer {
            background-color: var(--header-bg);
            border-color: var(--border-color);
        }

        footer {
            background-color: var(--footer-bg);
        }

        /* Toggle switch styles */
        .theme-switch-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-left: 20px;
        }

        .theme-switch {
            display: inline-block;
            position: relative;
            width: 60px;
            height: 30px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 30px;
            box-shadow: inset 0 0 5px rgba(20, 9, 9, 0.2);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 0 3px rgba(0,0,0,0.3);
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .slider .icons {
            display: flex;
            justify-content: space-between;
            padding: 5px 10px;
            color: white;
        }
        
        .theme-label {
            font-size: 0.8rem;
            margin-top: 5px;
            font-weight: bold;
            color: red;
        }

        .upload-container {
            position: relative;
            border: 3px dashed var(--primary-color);
            border-radius: 8px;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: rgba(153, 50, 204, 0.08);
            margin: 2rem auto;
            max-width: 600px;
            box-shadow: 0 4px 12px var(--shadow-color);
        }

        .upload-container:hover {
            background-color: rgba(153, 50, 204, 0.15);
            border-color: #8a2be2;
            transform: translateY(-3px);
        }

        .upload-container.dragover {
            background-color: rgba(153, 50, 204, 0.25);
            border-color: #8a2be2;
            transform: scale(1.03);
        }

        .upload-container i {
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }

        .file-info {
            display: none;
            margin: 2rem 0;
            padding: 1.5rem;
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 8px var(--shadow-color);
        }

        .progress-bar {
            height: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
            margin: 1.5rem 0;
            overflow: hidden;
            display: none;
        }

        .progress {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin: 1.5rem 0;
        }

        .convert-btn, .download-btn, .reset-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .convert-btn {
            background-color: var(--primary-color);
            color: white;
        }

        .convert-btn:hover {
            background-color: #8a2be2;
            transform: translateY(-2px);
        }

        .convert-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .reset-btn {
            background-color: #6c757d;
            color: white;
        }

        .reset-btn:hover {
            background-color: #5a6268;
        }

        .download-btn {
            display: none;
            background-color: #28a745;
            color: white;
            text-decoration: none;
            text-align: center;
        }

        .download-btn:hover {
            background-color: #218838;
            transform: translateY(-2px);
        }

        .error-message {
            color: #dc3545;
            background-color: rgba(220, 53, 69, 0.1);
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
            display: none;
        }

        .settings-section {
            padding: 1rem;
            background-color: var(--card-bg);
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .settings-section h3 {
            margin-top: 0;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }

        .settings-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 1rem;
        }

        .settings-group {
            flex: 1;
            min-width: 200px;
        }

        .settings-group label {
            display: block;
            margin-bottom: 0.5rem;
        }

        select, input[type="number"] {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            color: var(--text-color);
            width: 100%;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin: 1rem 0;
        }

        .checkbox-group input {
            margin-right: 8px;
        }

        #document-preview {
            margin: 2rem 0;
            padding: 1rem;
            background-color: white;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 8px var(--shadow-color);
            max-height: 500px;
            overflow-y: auto;
            display: none;
        }

        #document-preview.dark-preview {
            background-color: #2d2d2d;
            color: #e0e0e0;
        }

        .preview-toggle {
            margin: 1rem 0;
        }

        .preview-toggle button {
            padding: 8px 16px;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .preview-toggle button.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <img src="logo-r.svg" alt="Resize_Orbi Logo" class="logo-img">
                <h1>Resize_Orbi</h1>
            </div>
            <ul class="nav-links">
                <li><a href="index.html">
                    <span style="color: #fb1616;"><h>Home</h></span>
                </a></li>
                <li><a href="index.html#about">
                    <span style="color: #fcfcfc;"><h>About</h></span>
                </a></li>
                <li><a href="index.html#contact">
                    <span style="color: #15ea12;"><h>Developed By</h></span>
                </a></li>
                <li class="theme-switch-wrapper">
                    <label class="theme-switch" for="checkbox">
                        <input type="checkbox" id="checkbox" />
                        <div class="slider">
                            <div class="icons">
                                <i class="fas fa-sun"></i>
                                <i class="fas fa-moon"></i>
                            </div>
                        </div>
                    </label>
                    <span class="theme-label">Light/Dark</span>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="converter-container">
            <h1>Word to PDF Converter</h1>
            <p>Convert your Word documents to PDF format quickly and easily.</p>
            
            <div class="upload-container">
                <i class="fas fa-file-word"></i>
                <h3>Upload Word File</h3>
                <p>Drag & drop your file here or click to browse</p>
                <p class="file-type-hint">Accepted formats: DOCX, DOC</p>
                <input type="file" id="file-input" accept=".docx,.doc">
            </div>
            
            <div class="file-info">
                <h3>Document Information</h3>
                <p>Filename: <span id="file-name"></span></p>
                <p>Size: <span id="file-size"></span></p>
                
                <div class="settings-section">
                    <h3>PDF Settings</h3>
                    <div class="settings-row">
                        <div class="settings-group">
                            <label for="page-size">Page Size:</label>
                            <select id="page-size">
                                <option value="a4">A4</option>
                                <option value="letter">Letter</option>
                                <option value="legal">Legal</option>
                                <option value="tabloid">Tabloid</option>
                            </select>
                        </div>
                        
                        <div class="settings-group">
                            <label for="orientation">Orientation:</label>
                            <select id="orientation">
                                <option value="portrait">Portrait</option>
                                <option value="landscape">Landscape</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="settings-row">
                        <div class="settings-group">
                            <label for="margin">Margin (mm):</label>
                            <input type="number" id="margin" min="0" max="50" value="10">
                        </div>
                        
                        <div class="settings-group">
                            <label for="font-size">Base Font Size:</label>
                            <select id="font-size">
                                <option value="small">Small</option>
                                <option value="medium" selected>Medium</option>
                                <option value="large">Large</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="preserve-styles" checked>
                        <label for="preserve-styles">Preserve original document styles</label>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="include-images" checked>
                        <label for="include-images">Include images</label>
                    </div>
                </div>

                <div class="preview-toggle">
                    <button id="preview-btn" class="active">Preview Document</button>
                    <button id="hide-preview-btn">Hide Preview</button>
                </div>
                
                <div id="document-preview"></div>
                
                <div class="progress-bar">
                    <div class="progress"></div>
                </div>
                
                <div class="button-group">
                    <button id="convert-btn" class="convert-btn">Convert to PDF</button>
                    <button id="reset-btn" class="reset-btn">Clear & Upload New</button>
                </div>
                
                <a href="#" id="download-btn" class="download-btn">Download PDF</a>
                
                <p class="error-message" id="error-message"></p>
            </div>
            
            <div class="conversion-info">
                <h3>About Word to PDF Conversion</h3>
                <p>Our Word to PDF converter allows you to convert Microsoft Word documents to PDF format with high accuracy. This is useful when you need to:</p>
                <ul>
                    <li>Share documents that maintain their formatting across devices</li>
                    <li>Create a non-editable version of your document</li>
                    <li>Ensure your document looks the same for all viewers</li>
                    <li>Make your document more accessible and compatible with different platforms</li>
                </ul>
                <p>The conversion process preserves the original formatting, images, tables, and text styles of your Word document, resulting in a professional-looking PDF file.</p>
            </div>
        </section>
    </main>

    <footer>
       <div class="footer-content">
            <div class="footer-section">
                <h3>
                  <span style="color: #d84d4d;"><h>Resize_Orbi</h></span>
                </h3>
                <p>Your one-stop solution for all file conversion needs</p>
            </div>
            <div class="footer-section">
                <h3>
                    <span style="color: #d84d4d;"><h1>Quick Acton</h1></span>
                </h3>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html#about">About</a></li>
                    <li><a href="index.html#contact">Developd By</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3><span style="color: #d84d4d;"><h>Contact With Developer</h></span>

                </h3>
                <p>Email:satyajitpratihar26@gmail.com</p>
                
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2023 Resize_Orbi. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Theme switcher
            const toggleSwitch = document.querySelector('#checkbox');
            const currentTheme = localStorage.getItem('theme');
            
            // Check if theme is already stored
            if (currentTheme) {
                document.documentElement.setAttribute('data-theme', currentTheme);
                if (currentTheme === 'dark') {
                    toggleSwitch.checked = true;
                    document.getElementById('document-preview').classList.add('dark-preview');
                }
            }
            
            // Handle theme switch
            function switchTheme(e) {
                if (e.target.checked) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                    localStorage.setItem('theme', 'dark');
                    document.getElementById('document-preview').classList.add('dark-preview');
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                    localStorage.setItem('theme', 'light');
                    document.getElementById('document-preview').classList.remove('dark-preview');
                }    
            }
            
            // Add event listener for theme switch
            toggleSwitch.addEventListener('change', switchTheme, false);
            
            // Word to PDF Converter functionality
            const fileInput = document.getElementById('file-input');
            const uploadContainer = document.querySelector('.upload-container');
            const fileInfo = document.querySelector('.file-info');
            const fileName = document.getElementById('file-name');
            const fileSize = document.getElementById('file-size');
            const documentPreview = document.getElementById('document-preview');
            const previewBtn = document.getElementById('preview-btn');
            const hidePreviewBtn = document.getElementById('hide-preview-btn');
            const convertBtn = document.getElementById('convert-btn');
            const resetBtn = document.getElementById('reset-btn');
            const downloadBtn = document.getElementById('download-btn');
            const errorMessage = document.getElementById('error-message');
            const progressBar = document.querySelector('.progress');
            const pageSize = document.getElementById('page-size');
            const orientation = document.getElementById('orientation');
            const margin = document.getElementById('margin');
            const fontSize = document.getElementById('font-size');
            const preserveStyles = document.getElementById('preserve-styles');
            const includeImages = document.getElementById('include-images');
            
            // Variables to store file data
            let selectedFile = null;
            let htmlContent = '';
            let downloadUrl = null;
            
            // Preview toggle handlers
            previewBtn.addEventListener('click', function() {
                if (htmlContent) {
                    documentPreview.style.display = 'block';
                    this.classList.add('active');
                    hidePreviewBtn.classList.remove('active');
                } else {
                    showError('No document to preview.');
                }
            });
            
            hidePreviewBtn.addEventListener('click', function() {
                documentPreview.style.display = 'none';
                this.classList.add('active');
                previewBtn.classList.remove('active');
            });
            
            // Handle file selection
            fileInput.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    handleFileSelection(e.target.files[0]);
                }
            });
            
            // Drag and drop handlers
            uploadContainer.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('dragover');
            });
            
            uploadContainer.addEventListener('dragleave', function() {
                this.classList.remove('dragover');
            });
            
            uploadContainer.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
                
                if (e.dataTransfer.files.length > 0) {
                    handleFileSelection(e.dataTransfer.files[0]);
                }
            });
            
            // Click to select file
            uploadContainer.addEventListener('click', function() {
                fileInput.click();
            });
            
            // Handle reset button
            resetBtn.addEventListener('click', function() {
                resetForm();
            });
            
            // Handle convert button
            convertBtn.addEventListener('click', function() {
                if (!selectedFile) {
                    showError('Please select a Word document.');
                    return;
                }
                
                convertWordToPdf();
            });
            
            // Function to handle file selection
            function handleFileSelection(file) {
                // Check if it's a Word document
                if (!file.type.match('application/vnd.openxmlformats-officedocument.wordprocessingml.document') && 
                    !file.type.match('application/msword')) {
                    showError('Please select a valid Word document (DOC or DOCX).');
                    return;
                }
                
                // Store the file
                selectedFile = file;
                fileName.textContent = file.name;
                fileSize.textContent = formatFileSize(file.size);
                
                // Show file info section
                fileInfo.style.display = 'block';
                
                // Hide download button
                downloadBtn.style.display = 'none';
                
                // Load the Word document and convert to HTML for preview
                loadWordDocument(file);
            }
            
            // Function to load Word document
            function loadWordDocument(file) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const arrayBuffer = e.target.result;
                    
                    // Show progress bar
                    progressBar.parentElement.style.display = 'block';
                    progressBar.style.width = '0%';
                    
                    // Convert DOCX to HTML using mammoth.js
                    mammoth.convertToHtml({ arrayBuffer: arrayBuffer }, {
                        includeDefaultStyleMap: preserveStyles.checked,
                        convertImage: includeImages.checked ? mammoth.images.imgElement : undefined
                    })
                    .then(function(result) {
                        htmlContent = result.value;
                        documentPreview.innerHTML = htmlContent;
                        
                        // Apply styles based on settings
                        applyStyles();
                        
                        // Show preview if preview button is active
                        if (previewBtn.classList.contains('active')) {
                            documentPreview.style.display = 'block';
                        }
                        
                        // Update progress
                        progressBar.style.width = '100%';
                        
                        // Hide progress bar after a delay
                        setTimeout(function() {
                            progressBar.parentElement.style.display = 'none';
                            progressBar.style.width = '0%';
                        }, 1000);
                        
                        // Log any warnings
                        result.messages.forEach(function(message) {
                            console.warn(message);
                        });
                    })
                    .catch(function(error) {
                        showError('Error converting document: ' + error.message);
                        console.error(error);
                    });
                };
                
                reader.onerror = function() {
                    showError('Error reading file.');
                };
                
                reader.readAsArrayBuffer(file);
            }
            
            // Function to apply styles based on settings
            function applyStyles() {
                const baseFontSize = fontSize.value === 'small' ? '14px' : (fontSize.value === 'large' ? '18px' : '16px');
                
                // Apply base font size to preview
                documentPreview.style.fontSize = baseFontSize;
                
                // Apply theme specific styles
                if (document.documentElement.getAttribute('data-theme') === 'dark') {
                    documentPreview.classList.add('dark-preview');
                } else {
                    documentPreview.classList.remove('dark-preview');
                }
            }
            
            // Function to convert Word to PDF
            function convertWordToPdf() {
                if (!htmlContent) {
                    showError('Document content not available.');
                    return;
                }
                
                // Show progress bar
                progressBar.parentElement.style.display = 'block';
                progressBar.style.width = '0%';
                
                // Get settings
                const size = pageSize.value;
                const orient = orientation.value;
                const marginValue = parseInt(margin.value);
                
                // Set PDF dimensions
                let pageWidth, pageHeight;
                switch (size) {
                    case 'a4':
                        pageWidth = 210;
                        pageHeight = 297;
                        break;
                    case 'letter':
                        pageWidth = 216;
                        pageHeight = 279;
                        break;
                    case 'legal':
                        pageWidth = 216;
                        pageHeight = 356;
                        break;
                    case 'tabloid':
                        pageWidth = 279;
                        pageHeight = 432;
                        break;
                }
                
                // Swap dimensions if landscape
                if (orient === 'landscape') {
                    [pageWidth, pageHeight] = [pageHeight, pageWidth];
                }
                
                // Create a container for rendering
                const container = document.createElement('div');
                container.innerHTML = htmlContent;
                container.style.width = (pageWidth - (marginValue * 2)) + 'mm';
                container.style.padding = marginValue + 'mm';
                container.style.fontSize = fontSize.value === 'small' ? '12px' : (fontSize.value === 'large' ? '16px' : '14px');
                container.style.backgroundColor = 'white';
                container.style.color = 'black';
                
                // Apply additional styles
                const styleElem = document.createElement('style');
                styleElem.textContent = `
                    body {
                        font-family: 'Arial', sans-serif;
                        line-height: 1.5;
                    }
                    h1, h2, h3, h4, h5, h6 {
                        margin-top: 1em;
                        margin-bottom: 0.5em;
                    }
                    p {
                        margin: 0.5em 0;
                    }
                    table {
                        border-collapse: collapse;
                        width: 100%;
                        margin: 1em 0;
                    }
                    table, th, td {
                        border: 1px solid #ccc;
                    }
                    th, td {
                        padding: 0.5em;
                    }
                `;
                container.appendChild(styleElem);
                
                // Append to document for rendering but hide it
                container.style.position = 'absolute';
                container.style.left = '-9999px';
                document.body.appendChild(container);
                
                // Update progress
                progressBar.style.width = '30%';
                
                setTimeout(function() {
                    // Create PDF
                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF({
                        orientation: orient,
                        unit: 'mm',
                        format: size
                    });
                    
                    // Update progress
                    progressBar.style.width = '50%';
                    
                    html2canvas(container, {
                        scale: 2,
                        useCORS: true,
                        logging: false
                    }).then(function(canvas) {
                        // Update progress
                        progressBar.style.width = '80%';
                        
                        // Add image to PDF
                        const imgData = canvas.toDataURL('image/jpeg', 0.95);
                        
                        // Calculate scaling to fit page
                        const imgProps = pdf.getImageProperties(imgData);
                        const pdfWidth = pdf.internal.pageSize.getWidth() - (marginValue * 2);
                        const pdfHeight = pdf.internal.pageSize.getHeight() - (marginValue * 2);
                        const imgWidth = imgProps.width;
                        const imgHeight = imgProps.height;
                        
                        // Calculate scaling factor
                        const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);
                        const scaledWidth = imgWidth * ratio;
                        const scaledHeight = imgHeight * ratio;
                        
                        // Calculate centering
                        const x = marginValue + (pdfWidth - scaledWidth) / 2;
                        const y = marginValue + (pdfHeight - scaledHeight) / 2;
                        
                        // Add image to PDF
                        pdf.addImage(imgData, 'JPEG', x, y, scaledWidth, scaledHeight);
                        
                        // Create download URL
                        if (downloadUrl) {
                            URL.revokeObjectURL(downloadUrl);
                        }
                        
                        const pdfBlob = pdf.output('blob');
                        downloadUrl = URL.createObjectURL(pdfBlob);
                        
                        // Update download button
                        downloadBtn.href = downloadUrl;
                        downloadBtn.download = fileName.textContent.replace(/\.(docx|doc)$/i, '.pdf');
                        downloadBtn.style.display = 'inline-block';
                        
                        // Update progress
                        progressBar.style.width = '100%';
                        
                        // Hide progress bar after a delay
                        setTimeout(function() {
                            progressBar.parentElement.style.display = 'none';
                            progressBar.style.width = '0%';
                        }, 1000);
                        
                        // Remove temporary container
                        document.body.removeChild(container);
                        
                        // Scroll to download button
                        downloadBtn.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    });
                }, 500);
            }
            
            // Function to reset the form
            function resetForm() {
                // Reset file input
                fileInput.value = '';
                
                // Hide file info section
                fileInfo.style.display = 'none';
                
                // Clear selected file
                selectedFile = null;
                htmlContent = '';
                
                // Clear file name and size
                fileName.textContent = '';
                fileSize.textContent = '';
                
                // Clear document preview
                documentPreview.innerHTML = '';
                documentPreview.style.display = 'none';
                
                // Hide progress bar
                progressBar.parentElement.style.display = 'none';
                progressBar.style.width = '0%';
                
                // Hide download button
                downloadBtn.style.display = 'none';
                
                // Clean up URLs
                if (downloadUrl) {
                    URL.revokeObjectURL(downloadUrl);
                    downloadUrl = null;
                }
                
                // Clear error message
                errorMessage.style.display = 'none';
                errorMessage.textContent = '';
                
                // Reset settings to defaults
                pageSize.value = 'a4';
                orientation.value = 'portrait';
                margin.value = '10';
                fontSize.value = 'medium';
                preserveStyles.checked = true;
                includeImages.checked = true;
                
                // Reset preview buttons
                previewBtn.classList.add('active');
                hidePreviewBtn.classList.remove('active');
            }
            
            // Function to show error message
            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                setTimeout(function() {
                    errorMessage.style.opacity = '1';
                }, 10);
                setTimeout(function() {
                    errorMessage.style.opacity = '0';
                    setTimeout(function() {
                        errorMessage.style.display = 'none';
                    }, 500);
                }, 5000);
            }
            
            // Helper function to format file size
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
            
            // Add event listeners for settings changes to update preview
            fontSize.addEventListener('change', applyStyles);
            preserveStyles.addEventListener('change', function() {
                if (selectedFile) {
                    loadWordDocument(selectedFile);
                }
            });
            includeImages.addEventListener('change', function() {
                if (selectedFile) {
                    loadWordDocument(selectedFile);
                }
            });
        });
    </script>
</body>
</html> 